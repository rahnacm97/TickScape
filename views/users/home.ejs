<%- include("../../views/partials/user/header") %>

<!-- External Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>
  body {
    font-family: 'Arial', sans-serif;
    color: #333;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    background-color: #f8f9fa;
  }

  .hero__slider .hero__items {
    height: 450px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-size: cover;
    background-position: center;
    position: relative;
  }

  .hero__text {
    color: #fff;
    text-align: left;
    padding: 20px;
    background: rgba(4, 4, 4, 0.4);
    border-radius: 10px;
  }

  .hero__text h6 { font-size: 18px; margin-bottom: 10px; letter-spacing: 1.2px; text-transform: uppercase; }
  .hero__text h2 { font-size: 36px; margin-bottom: 15px; }
  .hero__text p { font-size: 16px; margin-bottom: 20px; }
  .primary-btn { background-color: #0d60dc; color: #fff; padding: 10px 20px; border-radius: 5px; text-transform: uppercase; font-weight: bold; transition: background-color 0.3s ease; }
  .primary-btn:hover { background-color: #1142ac; color: #fff; }

  .banner__carousel { margin: 0 auto; }
  .banner__item { position: relative; overflow: hidden; border-radius: 15px; background-color: #fff; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); height: 300px; }
  .banner__item:hover { transform: scale(1.03); transition: transform 0.3s ease; }
  .banner__item__pic img { width: 100%; height: 100%; object-fit: cover; border-radius: 15px; }
  .banner__item__text { position: absolute; bottom: 20px; left: 20px; color: #fff; text-align: left; background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 10px; }
  .banner__item__text h2 { font-size: 24px; margin-bottom: 10px; }
  .banner__item__text a { font-size: 14px; color: #fff; background-color: #ff6b6b; padding: 8px 20px; border-radius: 5px; text-decoration: none; transition: background-color 0.3s ease; }
  .banner__item__text a:hover { background-color: #ff4c4c; }

  .owl-nav { position: absolute; top: 50%; width: 100%; transform: translateY(-50%); display: flex; justify-content: space-between; padding: 0 15px; }
  .owl-nav button { background: rgba(255, 255, 255, 0.8) !important; border-radius: 50%; width: 40px; height: 40px; font-size: 20px !important; color: #ff6b6b !important; transition: background 0.3s ease; }
  .owl-nav button:hover { background: #fff !important; color: #ff4c4c !important; }
  .owl-dots { text-align: center; margin-top: 10px; }
  .owl-dot { background: #ccc !important; width: 10px; height: 10px; border-radius: 50%; margin: 0 5px; display: inline-block; }
  .owl-dot.active { background: #ff6b6b !important; }

  .product-cart-wrap { border: 1px solid #eee; border-radius: 10px; overflow: hidden; transition: box-shadow 0.3s ease, transform 0.3s ease; background-color: #fff; }
  .product-cart-wrap:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15); }
  .product-img { position: relative; overflow: hidden; height: 250px; background-color: #f9f9f9; }
  .product-img img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
  .product-img:hover img { transform: scale(1.1); }
  .wishlist-btn { position: absolute; top: 15px; right: 15px; background-color: rgba(255, 255, 255, 0.9); padding: 8px; border-radius: 50%; color: #ff6b6b; font-size: 18px; cursor: pointer; transition: all 0.3s ease; }
  .wishlist-btn:hover { background-color: #fff; color: #ff4c4c; }
  .product-content-wrap { padding: 15px; text-align: center; }
  .product-content-wrap h6 { font-size: 18px; margin-bottom: 10px; color: #333; font-weight: 600; }
  .product-content-wrap h5 { font-size: 16px; margin-bottom: 15px; color: #ff6b6b; font-weight: bold; }
  .product-content-wrap a button { font-size: 14px; text-transform: uppercase; color: #fff; background-color: #ff6b6b; padding: 8px 12px; border: none; border-radius: 5px; text-decoration: none; transition: background-color 0.3s ease; }
  .product-content-wrap a button:hover { background-color: #ff4c4c; }
  .add-to-cart-btn { background-color: #0b65d4; }

  /* Responsive Media Queries */
  @media (max-width: 768px) {
    .hero__items { height: 350px; }
    .hero__text h2 { font-size: 28px; }
    .hero__text h6 { font-size: 16px; }
    .hero__text p { font-size: 14px; }
    .banner__item { height: 300px; }
    .banner__item__text h2 { font-size: 18px; }
    .banner__item__text a { font-size: 12px; padding: 6px 15px; }
    .product-img { height: 300px; }
    .product-content-wrap h6 { font-size: 16px; }
    .product-content-wrap h5 { font-size: 14px; }
    .product-content-wrap a button { font-size: 12px; padding: 6px 10px; }
    .owl-nav button { width: 30px; height: 30px; font-size: 16px !important; }
  }

  @media (max-width: 576px) {
    .hero__items { height: 350px; }
    .hero__text { padding: 15px; }
    .hero__text h2 { font-size: 20px; }
    .hero__text h6 { font-size: 14px; }
    .hero__text p { font-size: 12px; }
    .banner__item { height: 200px; }
    .banner__item__text { bottom: 10px; left: 10px; padding: 8px; }
    .banner__item__text h2 { font-size: 16px; }
    .banner__item__text a { font-size: 10px; padding: 4px 10px; }
    .product-img { height: 300px; }
    .col-lg-3, .col-md-4, .col-sm-6 { flex: 0 0 50%; max-width: 50%; }
    .product-content-wrap h6 { font-size: 14px; }
    .product-content-wrap h5 { font-size: 12px; }
    .product-content-wrap a button { font-size: 10px; padding: 4px 8px; }
    .wishlist-btn { top: 10px; right: 10px; padding: 6px; font-size: 16px; }
    .owl-nav { display: none; } /* Hide navigation arrows on very small screens */
  }

  @media (max-width: 400px) {
    .col-lg-3, .col-md-4, .col-sm-6 { flex: 0 0 100%; max-width: 100%; }
    .hero__text { padding: 10px; }
    .banner__item { height: 200px; }
    .banner__item__text h2 { font-size: 14px; }
    .product-img { height: 300px; }
  }
</style>

<!-- Hero Section -->
<section class="hero">
  <div class="hero__slider owl-carousel owl-theme">
    <div class="hero__items" style="background-image: url('assets/img/banner/futuristic-time-machine.jpg');">
        <div class="container">
            <div class="row">
              <div class="col-lg-6 col-md-8">
                <div class="hero__text">
                  <h6>Summer Collection</h6>
                  <h2>Fall - Winter Collections 2030</h2>
                  <p>A specialist label creating luxury essentials. Ethically created.</p>
                </div>
              </div>
            </div>
          </div>
    </div>
    <div class="hero__items" style="background-image: url('assets/img/banner/futuristic-technology.jpg');">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 col-md-8">
            <div class="hero__text">
              <h6>Summer Collection</h6>
              <h2>Fall - Winter Collections 2030</h2>
              <p>A specialist label creating luxury essentials.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Banner Carousel Section -->
<section class="banner py-5">
  <div class="container">
    <div class="banner__carousel owl-carousel owl-theme">
        <div class="banner__item">
          <div class="banner__item__pic">
            <img src="assets/img/banner/new2.jpg" alt="Clothing Collections 2030">
          </div>
          <div class="banner__item__text">
            <h2>Daily Collections 2030</h2>
            <a href="#">Shop Now</a>
          </div>
        </div>
        <div class="banner__item">
          <div class="banner__item__pic">
            <img src="assets/img/banner/new3.jpg" alt="Accessories">
          </div>
          <div class="banner__item__text">
            <h2>Accessories</h2>
            <a href="#">Shop Now</a>
          </div>
        </div>
        <div class="banner__item">
          <div class="banner__item__pic">
            <img src="assets/img/banner/new4.jpg" alt="Shoes Spring 2030">
          </div>
          <div class="banner__item__text">
            <h2>Shoes Spring 2030</h2>
            <a href="#">Shop Now</a>
          </div>
        </div>
    </div>
  </div>
</section>

<!-- Product Section -->
<section class="product py-5">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <ul class="filter__controls text-center mb-4">
          <li data-filter=".new-arrivals"><h1>New Arrivals</h1></li>
        </ul>
      </div>
    </div>
    <div class="row product__filter">
      <% for(let i = 0; i < products.length; i++) { %>
      <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
        <div class="product-cart-wrap">
          <div class="product-img-action-wrap">
            <div class="product-img product-img-zoom">
              <a href="/productDetails?id=<%=products[i]._id%>">
                <img class="default-img" src="/<%= products[i].productImage[0]%>" alt="<%=products[i].productName%>">
              </a>
            </div>
            <span class="wishlist-btn" onclick="addToWishlist('<%= products[i]._id %>')">❤️</span>
          </div>
          <div class="product-content-wrap">
            <h6><%=products[i].productName%></h6>
            <h5>₹<%=products[i].salePrice%></h5>
            <a><button class="add-to-cart-btn" onclick="addToCart('<%= products[i]._id %>')">Add to Cart</button></a>
          </div>
        </div>
      </div>
      <% } %>
    </div>
  </div>
</section>

<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  jQuery(document).ready(function($) {
    console.log("jQuery version:", $.fn.jquery); // Expect "3.6.0"
    console.log("Owl Carousel available:", typeof $.fn.owlCarousel !== 'undefined'); // Expect "true"

    // Hero Slider
    $(".hero__slider").owlCarousel({
      loop: true,
      margin: 10,
      nav: true,
      dots: true,
      autoplay: true,
      autoplayTimeout: 3000,
      items: 1
    });
    console.log("Hero slider initialized");

    // Banner Carousel
    $(".banner__carousel").owlCarousel({
      loop: true,
      margin: 20,
      nav: true,
      dots: true,
      autoplay: true,
      autoplayTimeout: 4000,
      responsive: {
        0: { items: 1 },
        768: { items: 2 },
        1200: { items: 3 }
      }
    });
    console.log("Banner carousel initialized");
  });

  function addToWishlist(productId) {
    jQuery.ajax({
      url: '/addToWishlist',
      method: 'POST',
      data: { productId: productId },
      success: (response) => {
        if (response.status) {
          Swal.fire({
            title: 'Added to Wishlist',
            text: 'The product has been added to your wishlist',
            icon: 'success',
            showCancelButton: true,
            confirmButtonText: 'Go to Wishlist',
            cancelButtonText: 'OK'
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = '/wishlist';
            }
          });
        } else {
          Swal.fire({
            title: 'Already in Wishlist',
            text: response.message,
            icon: 'info',
            showCancelButton: true,
            confirmButtonText: 'Go to Wishlist'
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = '/wishlist';
            }
          });
        }
      },
      error: () => {
        Swal.fire('Error', 'There was an error adding to wishlist', 'error');
      }
    });
  }

  function addToCart(productId) {
    jQuery.ajax({
      url: '/addToCart',
      method: 'POST',
      data: { productId: productId },
      success: (response) => {
        if (response.status) {
          Swal.fire({
            title: 'Added to Cart',
            text: response.message || 'The product has been added to your cart.',
            icon: 'success',
            timer: 2000,
            showCancelButton: true,
            confirmButtonText: 'Go to Cart',
            cancelButtonText: 'Okay!'
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = '/cart';
            }
          });
        } else {
          Swal.fire({
            title: 'Already in Cart',
            text: response.message || 'This product is already in your cart.',
            icon: 'info',
            timer: 2000
          });
        }
      },
      error: () => {
        Swal.fire('Error', 'There was an error adding to cart', 'error');
      }
    });
  }
</script>

<%- include("../../views/partials/user/footer") %>