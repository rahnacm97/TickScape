<%- include("../../views/partials/user/header") %>
<style>
  .small-card {
    max-width: auto; 
    font-size: 12px; 
}
.small-card .card-body {
    padding: 5px;
}
.small-card .price {
    font-size: 14px;
    font-weight: bold;
}
.small-card .btn-small1 {
    font-size: 12px;
    padding: 3px 8px;
}
.order-card {
    padding: 10px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  .price {
    font-size: 1.2rem;
    font-weight: bold;
  }
  .search-bar input {
    width: 100%;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #ccc;
  }
  
  body {
    font-family: 'Arial', sans-serif;
    background-color: #f8f9fa;
    margin: 0;
    padding: 0;
  }

  .main {
    padding: 20px 0;
  }

  .card {
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
    background-color: #ffffff;
  }

  .card-header {
    background-color: #37438b;
    color: #fff;
    font-size: 18px;
    font-weight: bold;
    border-radius: 10px 10px 0 0;
    padding: 15px;
    text-align: center;
  }

  .card-body {
  padding: 20px;
  line-height: 2;
}

  .btn {
    border-radius: 5px;
    transition: background-color 0.3s, transform 0.2s;
    margin-top: 10px;
  }

  .btn-success {
    background-color: #2657a0;
    color: #fff;
    border: none;
    margin-left: 20px;
  }

  .btn-success:hover {
    background-color: #19377e;
    transform: scale(1.05);
  }

  .btn-small {
    font-size: 14px;
    padding: 5px 10px;
    border-radius: 5px;
    background-color: #5c6bc0;
    color: #fff;
    text-decoration: none;
    border: none;
    transition: background-color 0.3s ease;
  }

  .btn-small:hover {
    background-color: #3f51b5;
  }

  .dashboard-menu {
    background-color: #f0f3f3;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .dashboard-menu .nav-link {
    font-size: 16px;
    font-weight: bold;
    color: #0e0e12;
    padding: 10px;
    margin-bottom: 5px;
    border-radius: 5px;
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  .dashboard-menu .nav-link.active {
    background-color: #089f7c;
    color: #fff;
  }

  .dashboard-menu .nav-link:hover {
    background-color: #048b6b;
    color: #fff;
  }

  .page-header.breadcrumb-wrap {
    margin-top: 10px;
    background-color: #ede9ec;
    padding: 10px 0;
}

.breadcrumb-wrap {
    padding: 15px 0;
    background-color: #1e918b;
    color: #fff;
}

.breadcrumb a {
    color: #088178;
    text-decoration: none;
}

.breadcrumb span {
    margin: 0 5px;
    color: rgb(125, 124, 124);
}

  /* Responsive Styles */
  @media (max-width: 768px) {
    .dashboard-menu {
      padding: 10px;
    }

    .dashboard-menu .nav-link {
      font-size: 14px;
    }

    .card-header {
      font-size: 16px;
    }

    .btn-small {
      font-size: 12px;
    }
  }

  .tab-pane{
    padding: 20px;
    
  }

  .card{
    border: 1px solid #dee2e6;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    background-color: #ffffff;
    margin-bottom: 20px;
    transition: transform 0.2s ease-in-out;
  }

  .card:hover {
    transform: scale(1.02);
  }

  .card-header {
    background-color: #007bff;
    color: #ffffff;
    font-weight: bold;
    padding: 15px;
    border-radius: 10px 10px 0 0;
    text-align: center;
  }

  .card-body {
    padding: 20px;
    line-height: 1;
  }

  address {
    font-style: normal;
    margin-bottom: 15px;
    color: #120d0d;
  }

  .card-body p {
    margin: 5px 0;
  }
  .btn-small1{
    display: block; 
    width: fit-content; 
    margin-left: auto;
    margin-right: auto;
    font-size: 14px;
    padding: 8px 12px;
    border-radius: 5px;
    color: #ffffff;
    text-decoration: none;
    transition: background-color 0.3s ease, transform 0.2s ease-in-out;
    display: inline-block;
    background-color: #007bff;
  }
  .btn-small1:hover {
    transform: scale(1.05);
    color: white;
    background-color: #17406c;
  }

  .btn-small {
    font-size: 14px;
    padding: 8px 12px;
    border-radius: 5px;
    color: #ffffff;
    text-decoration: none;
    transition: background-color 0.3s ease, transform 0.2s ease-in-out;
    display: inline-block;
  }

  .btn-small:hover {
    transform: scale(1.05);
    color: white;
  }

  .btn-small:first-child {
    background-color: #007bff;
  }

  .btn-small:first-child:hover {
    background-color: #0056b3;
  }

  .btn-small:last-child {
    background-color: #dc3545;
  }

  .btn-small:last-child:hover {
    background-color: #c82333;
  }

  .btn-primary {
    background-color: #136d28;
    border: none;
    color: #ffffff;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    border-radius: 5px;
    cursor: pointer;
    display: inline-block;
    margin-top: 20px;
    transition: background-color 0.3s ease-in-out;
  }

  .btn-primary:hover {
    background-color: #0a4817;
  }

  .d-flex {
    display: flex;
    justify-content: space-between;
    margin-top: 15px;
  }

  .pagination {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 20px 0;
}

.pagination a {
  padding: 8px 12px;
  background-color: #fff;
  border: 1px solid #ddd;
  color: #333;
  text-decoration: none;
  border-radius: 4px;
  transition: background-color 0.3s ease, transform 0.2s;
}

.pagination a:hover {
  background-color: #1e918b;
  color: white;
  transform: scale(1.05);
}

.pagination .active {
  background-color: #1e918b;
  color: white;
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<main class="main">
 <div class="page-header breadcrumb-wrap mb-3">
   <div class="container">
     <div class="breadcrumb">
       <a href="/" rel="nofollow">Home</a>
       <span></span> Profile 
     </div>
   </div>
 </div>
  <section class="pt-10 pb-10">
   <div class="container">
     <div class="row">
       <div class="col-lg-12 m-auto">
         <div class="row">
           <div class="col-md-4">
             <div class="dashboard-menu ms-1">
               <ul class="nav flex-column" role="tablist">
                 <li class="nav-item">
                   <a class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" href="#dashboard" role="tab" aria-controls="dashboard" aria-selected="false">
                     <i class="fi-rs-settings-sliders mr-10"></i>Dashboard
                   </a>
                 </li>
                 <li class="nav-item">
                  <a class="nav-link" href="/address">
                     <i class="fi-rs-marker mr-10"></i>My Address
                   </a>
                 </li>
                 <li class="nav-item">
                  <a class="nav-link" href="/orders">
                      <i class="fi-rs-shopping-bag mr-10"></i>Orders
                  </a>
              </li>
                 <li class="nav-item">
                   <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab" href="#track-orders" role="tab" aria-controls="track-orders" aria-selected="false">
                    <i class="fas fa-wallet mr-10"></i>Wallet Status
                   </a>
                 </li>
                 <li class="nav-item">
                   <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab" href="#wallet-history" role="tab" aria-controls="track-orders" aria-selected="false">
                    <i class="fas fa-history mr-10"></i> History
                   </a>
                 </li>
                 <li class="nav-item">
                   <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab" href="#referal" role="tab" aria-controls="track-orders" aria-selected="false">
                    <i class="fas fa-user-friends mr-10"></i> Referrals
                   </a>
                 </li>
                 <li class="nav-item">
                   <a class="nav-link" href="/logout">
                     <i class="fi-rs-sign-out mr-10"></i>Logout
                   </a>
                 </li>
               </ul>
             </div>
           </div>
           <div class="col-md-8">
             <div class="tab-content dashboard-content">
               <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                 <div class="card card-green">
                   <div class="card-header">
                     <h5 class="mb-0 text-center">My Profile</h5>
                     <a href="javascript:void(0);" onclick="confirmEdit('<%= user._id %>')" style="margin-left: 600px; font-size: 12px;">Edit</a>
                   </div>
                   <div class="card-body text-center">
                     <h5 class="card-title"><%= user.fname %> <%= user.lname %></h5>
                     <p class="card-text">
                       <strong>Phone: </strong><%= user.phone %>
                     </p>
                     <p class="card-text">
                       <strong>Email: </strong><%= user.email %>
                     </p>
                     <a href="/change-email" class="btn btn-sm btn-success ml-2">Change Email</a>
                     <a href="/change-password" class="btn btn-sm btn-success">Change Password</a>
                   </div>
                 </div>
               </div>


               <div class="tab-pane fade" id="track-orders" role="tabpanel" aria-labelledby="track-orders-tab">
                 <div class="card">
                   <div class="card-header">
                     <h5 class="mb-0">Wallet</h5>
                   </div>
                   <div class="card-body contact-from-area">
                     <div class="row">
                       <div class="col-lg-8 mx-auto text-center mt-90">
                         <form>
                           <div class="form-group">
                             <label for="walletAmount" class="h4">Amount</label>
                             <div class="h3">
                              ₹<%= user.wallet.reduce((sum, entry) => sum + entry.amount, 0) %>
                             </div>
                           </div>
                           <button type="button" class="btn btn-success" onclick="">Add Money</button>
                         </form>
                       </div>
                     </div>
                   </div>
                 </div>
               </div>


               <div class="tab-pane fade" id="wallet-history" role="tabpanel" aria-labelledby="orders-tab">
                 <div class="card">
                   <div class="card-header">
                     <h5 class="mb-0">Wallet History</h5>
                   </div>
                   <div class="card-body">
                     <div class="table-responsive">
                      <table class="table">
                        <thead>
                          <tr>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Amount</th>
                          </tr>
                        </thead>
                        <tbody>
                          <% user.wallet.forEach(entry => { %>
                            <tr>
                              <td><%= new Date(entry.date).toDateString() %></td>
                              <td>Active</td>
                              <td>₹<%= entry.amount %></td>
                            </tr>
                          <% }) %>
                        </tbody>
                      </table>                      
                     </div>
                   </div>
                 </div>
               </div>


               <div class="tab-pane fade" id="referal" role="tabpanel" aria-labelledby="track-orders-tab">
                <div class="card shadow-sm border-0 rounded-lg">
                  <div class="card-header bg-primary text-white py-3">
                    <h5 class="mb-0 font-weight-bold">Referal</h5>
                  </div>
                  <div class="card-body p-4">
                    <h6 class="mb-3 text-secondary font-weight-bold">Refer your friends and earn money!</h6>
                    
                    <div class="referral-code-container p-3 my-4 bg-light rounded border">
                      <p class="mb-2">Share this link:</p>
                      <div class="input-group">
                        <input type="text" class="form-control" value="<%= user.referalCode %>" readonly>
                        <div class="input-group-append">
                          <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('<%= user.referalCode %>')">
                            <i class="fas fa-copy"></i> Copy
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <div class="earnings-container p-3 bg-success text-white rounded">
                      <p class="mb-0">Earned: <span class="h4 font-weight-bold">₹<%= user.wallet.reduce((sum, entry) => sum + entry.amount, 0) %></span></p>
                    </div>
                    
                    <!-- <div class="mt-4 text-center">
                      <button class="btn btn-primary">
                        <i class="fas fa-share-alt mr-2"></i> Share on Social Media
                      </button>
                    </div> -->
                  </div>
                </div>
              </div>
              
              <script>
              function copyToClipboard(text) {
                navigator.clipboard.writeText(text).then(function() {
                  alert('Referral code copied to clipboard!');
                }, function() {
                  alert('Failed to copy referral code');
                });
              }
              </script>
       </div>
     </div>
   </div>
 </section>
</main>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function confirmEdit(userId) {
        Swal.fire({
            title: "Are you sure?",
            text: "Do you want to edit your profile?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "Yes, go to edit!",
            cancelButtonText: "Cancel"
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = `/edit-profile?id=${userId}`;
            }
        });
    }
</script>
<%- include("../../views/partials/user/footer") %>
