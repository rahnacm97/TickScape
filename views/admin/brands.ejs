<%- include("../../views/partials/admin/header") %>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
  body {
  font-family: 'Roboto', sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f4f5f7;
}

.content-main {
  padding: 20px;
}

.content-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.content-title {
  font-size: 32px;
  font-weight: 700;
  color: #333;
}

.card-header {
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
}

.search-container {
  display: flex;
  justify-content: flex-end; 
  width: 100%;
  max-width: 1000px;
  margin: 0 auto;
  padding: 20px 0;
  border-radius: 25px;
}

.input-group {
  display: flex;
  flex: 1;
  margin-right: 10px;
}

.form-control {
  flex: 1;
  padding: 10px;
  font-size: 16px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.btn {
  margin-right: 10px;
  padding: 10px 20px;
  font-size: 14px;
  border-radius: 50px;
  background-color: #007bff;
  color: #fff;
  padding: 10px 15px;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.btn:hover {
  background-color: #0056b3;
}

.table-responsive {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        width: 100%;
      }
  
      .table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
      }
  
      .table th,
      .table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
  
      .table th {
        background-color: #f8f9fa;
        font-weight: 500;
      }

.pagination-container {
  text-align: center;
  margin-top: 20px;
}

.pagination a,
.pagination .current-page {
  padding: 8px 16px;
  margin: 0 4px;
  border-radius: 30px;
  text-decoration: none;
  background-color: #f0f0f0;
  color: #333;
  transition: background-color 0.3s ease;
}

.pagination a:hover {
  background-color: #007bff;
  color: white;
}

.pagination .current-page {
  background-color: #007bff;
  color: white;
}

.btn-danger {
  background-color: #dc3545;
  color: white;
}

.btn-danger:hover {
  background-color: #c82333;
}

.btn-info {
  background-color: #17a2b8;
  color: white;
}

.btn-info:hover {
  background-color: #138496;
}

@media (max-width: 768px) {
  .content-main {
    padding: 15px; 
  }

  .content-title {
    font-size: 24px; 
  }

  .content-header {
    flex-direction: column; 
    align-items: flex-start;
  }

  .search-container {
    flex-direction: column; 
    padding: 10px 0;
    justify-content: center;
  }

  .input-group {
    width: 100%; 
    margin-right: 0;
    flex-direction: column; 
  }

  .form-control {
    margin-bottom: 10px; 
    border-radius: 25px; 
  }

  .btn {
    width: 100%; 
    max-width: 200px; 
    margin: 0 auto; 
  }

  .btn-add-category {
    margin-top: 10px; 
    width: 100%;
    max-width: 200px;
    text-align: center;
  }

  .table-responsive {
    padding: 10px; 
    overflow-x: auto; 
  }

  .table th,
  .table td {
    padding: 8px; 
    font-size: 14px;
  }

  .table td button {
    width: 70px; 
    padding: 8px;
    font-size: 12px;
  }

  .pagination-container {
    display: flex;
    flex-wrap: wrap; 
    justify-content: center;
    gap: 5px; 
  }

  .pagination a,
  .pagination .current-page {
    padding: 6px 12px; 
    font-size: 12px;
  }
}

@media (max-width: 480px) {
  .content-title {
    font-size: 20px; 
  }

  .card-header {
    padding: 10px; 
  }

  .form-control {
    font-size: 14px; 
  }

  .btn {
    padding: 8px 12px; 
    font-size: 12px;
  }

  .table th,
  .table td {
    padding: 6px; 
    font-size: 12px; 
  }

  .table td button {
    width: 60px; 
    padding: 6px;
  }

  .table td .badge {
    width: 50px; 
    font-size: 12px;
  }

  .pagination a,
  .pagination .current-page {
    padding: 5px 10px;
    font-size: 10px;
  }
}
</style>
<section class="content-main">
  <div class="content-header">
    <div>
      <h2 class="content-title card-title">Brands</h2>
    </div>
  </div>
  <div>
    <header class="card-header">
      <div class="search-container">
          <form action="/admin/brands/" method="get" class="d-inline" style="margin-right: 500px;">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Search brands" name="search" value="<%= searchQuery %>" />
              <button class="btn" type="submit">Search</button>
            </div>
          </form>
        <a href="/admin/addBrand" class="btn btn-primary btn-add-category" data-section="brand">Add Brand +</a>
      </div>
    </header>
  </div>
        <div class="col-lg-12">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Sl. No</th>
                  <th>Brand</th>
                  <th>Logo</th>
                  <th>Status</th>
                  <th>Block/Unblock</th>
                  <th>Edit</th>
                  <th>Action</th>
                
                </tr>
              </thead>
              <tbody>
                <% data.reverse().forEach((brand,index) => { %>
                <tr>
                  <td class="text-center"><%= (currentPage - 1) * limit + index + 1 %></td>
                  <td class="text-start"><%= brand.brandName %></td>
                  <td class="text-start">
                    <div
                      class="d-flex align-items-center justify-content-center"
                      style="
                        width: 40px;
                        height: 40px;
                        border-radius: 50%;
                        overflow: hidden;
                      "
                    >
                      <img
                        src="http://localhost:3000/uploads/product-images/<%= brand.brandImage[0] %>"
                        alt="<%= brand.brandName %>"
                        class="img-fluid rounded-circle"
                        style="width: 50%; height: auto"
                      />
                    </div>
                  </td>
                  <td class="text-start">
                    <% if(brand.isBlocked === true){ %>
                    <span
                      class="badge rounded-pill alert-danger"
                      style="width: 60px"
                      >Blocked</span
                    >
                    <% } else { %>
                    <span
                      class="badge rounded-pill alert-success"
                      style="width: 60px"
                      >Active</span
                    >
                    <% } %>
                  </td>
                  <td class="text-start">
                    <% if (brand.isBlocked === false) { %>
                    <button class="btn btn-danger" style="width: 90px" onclick="confirmBrandAction('<%= brand._id %>', 'block')">
                      Block
                    </button>
                    <% } else { %>
                    <button class="btn btn-success" style="width: 90px" onclick="confirmBrandAction('<%= brand._id %>', 'unblock')">
                      Unblock
                    </button>
                    <% } %>
                  </td>                  
                  <td>
                    <button class="btn btn-success" style="width: 90px">
                      <a href="/admin/editBrand?id=<%= brand._id %>" class="text-white fas fa-edit" data-section="brand"></a>
                    </button>
                  </td>
                  <td>
                    <button
                      class="btn btn-danger"
                      style="width: 90px"
                      onclick="return confirmDelete()"
                    >
                      <a href="/admin/deleteBrand?id= <%= brand._id %>" class="text-white fas fa-trash btn-danger "></a>
                    </button>
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="pagination-container">
    <% if (currentPage > 1) { %>
    <a href="?page=<%= currentPage - 1 %>&search=<%= searchQuery %>">&laquo; Previous</a>
    <% } %>
    <% for (let i = 1; i <= totalPages; i++) { %>
    <% if (i === currentPage) { %>
    <span class="current-page"><%= i %></span>
    <% } else { %>
    <a href="?page=<%= i %>&search=<%= searchQuery %>"><%= i %></a>
    <% } %>
    <% } %>
    <% if (currentPage < totalPages) { %>
    <a href="?page=<%= currentPage + 1 %>&search=<%= searchQuery %>">Next &raquo;</a>
    <% } %>
  </div>
</div>
</section>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function confirmDelete(){
        return confirm("Are you sure, you want to delete this brand?");
    }
  function confirmBrandAction(brandId, action) {
    let actionText = action === 'block' ? "Block" : "Unblock";
    let actionUrl = action === 'block' ? `/admin/blockBrand?id=${brandId}` : `/admin/unBlockBrand?id=${brandId}`;

    Swal.fire({
      title: `Are you sure you want to ${actionText} this brand?`,
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: `Yes, ${actionText} it!`
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = actionUrl;
      }
    });
  }

</script>
<%- include("../../views/partials/admin/footer") %>

